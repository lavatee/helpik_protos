syntax = "proto3";
option go_package = ".;proto";
import "google/protobuf/timestamp.proto";

service Clients {
    rpc CreateAssistant(CreateAssistantRequest) returns (CreateAssistantResponse);
    rpc AddDocument(AddDocumentRequest) returns (AddDocumentResponse);
    rpc DeleteAssistant(DeleteAssistantRequest) returns (DeleteAssistantResponse);
    rpc DeleteDocument(DeleteDocumentRequest) returns (DeleteDocumentResponse);
    rpc GetOneAssistant(GetOneAssistantRequest) returns (GetOneAssistantResponse);
    rpc GetUserAssistants(GetUserAssistantsRequest) returns (GetUserAssistantsResponse);
    rpc GetAssistantDocuments(GetAssistantDocumentsRequest) returns (GetAssistantDocumentsResponse);
    rpc UpdateAssistant(UpdateAssistantRequest) returns (UpdateAssistantResponse);
    rpc GiveAnswer(GiveAnswerRequest) returns (GiveAnswerResponse);
    rpc GetAssistantGivenAnswers(GetAssistantGivenAnswersRequest) returns (GetAssistantGivenAnswersResponse);
    rpc DeleteGivenAnswer(DeleteGivenAnswerRequest) returns (DeleteGivenAnswerResponse);
    rpc CreateAppeal(CreateAppealRequest) returns (CreateAppealResponse);
    rpc GetAssistantAppeals(GetAssistantAppealsRequest) returns (GetAssistantAppealsResponse);
    rpc GetUserAssistantsAppeals(GetUserAssistantsAppealsRequest) returns (GetUserAssistantsAppealsResponse);
    rpc AddClientToQueue(AddClientToQueueRequest) returns (AddClientToQueueResponse);
    rpc GetOperatorChats(GetOperatorChatsRequest) returns (GetOperatorChatsResponse);
    rpc GetUserOperators(GetUserOperatorsRequest) returns (GetUserOperatorsResponse);
    rpc GetOneQueueClient(GetOneQueueClientRequest) returns (GetOneQueueClientResponse);
    rpc GetChatMessages(GetChatMessagesRequest) returns (GetChatMessagesResponse);
    rpc CreateMessage(CreateMessageRequest) returns (CreateMessageResponse);
    rpc CheckIsOperator(CheckIsOperatorRequest) returns (CheckIsOperatorResponse);
    rpc NewOperator(NewOperatorRequest) returns (NewOperatorResponse);
    rpc CheckIsAssistantOperator(CheckIsAssistantOperatorRequest) returns (CheckIsAssistantOperatorResponse);
}

message Assistant {
    int64 Id = 1;
    int64 UserId = 2;
    string Name = 3;
    string Tag = 4;
    string FirstMessage = 5;
    google.protobuf.Timestamp CreatedAt = 6;
    bool TelegramBotExists = 7;
    int64 TodayQuestions = 8;
    int64 ThisMonthQuestions = 9;
}

message Document {
    int64 Id = 1;
    int64 AssistantId = 2;
    string FileName = 3;
}

message GivenAnswer {
    int64 Id = 1;
    int64 AssistantId = 2;
    int64 UserId = 3;
    string Question = 4;
    string Answer = 5;
}

message Appeal {
    int64 Id = 1;
    string UserQuestion = 2;
    string AssistantAnswer = 3;
    string UserComment = 4;
    int64 AssistantId = 5;
    repeated string ChunksId = 6;
}

message Operator {
    int64 Id = 1;
    int64 UserId = 2;
    int64 AssistantId = 3;
    string AssistantName = 4;
    string Name = 5;
    google.protobuf.Timestamp LastCallTime = 6;
    bool IsBusy = 7;
    google.protobuf.Timestamp CreatedAt = 8;
    float AverageRating = 9;
    int64 ServicedClientsAmount = 10;
}

message OperatorQueue {
    int64 Id = 1;
    int64 OperatorId = 2;
    string ClientId = 3;
    string Problem = 4;
    string Status = 5;
    google.protobuf.Timestamp CreatedAt = 6;
    google.protobuf.Timestamp ServicedAt = 7;
    string ClientPlatform = 8;
    int64 Rating = 9;
    int64 ChatId = 10;
}

message Chat {
    int64 Id = 1;
    int64 QueueId = 2;
    string ClientId = 3;
    google.protobuf.Timestamp CreatedAt = 4;
    string QueueStatus = 5;
    string QueueProblem = 6;
    int64 UnreadMessagesAmount = 7;
    string LastMessage = 8;
}

message Message {
    int64 Id = 1;
    int64 ChatId = 2;
    string Text = 3;
    string Role = 4;
    bool IsRead = 5;
    google.protobuf.Timestamp SentAt = 6;
    google.protobuf.Timestamp ExpiresAt = 7;
}

message CreateAssistantRequest {
    int64 UserId = 1;
    string Name = 2;
    string Tag = 3;
    string FirstMessage = 4;
}

message CreateAssistantResponse {
    int64 AssistantId = 1;
    string APIToken = 2;
}

message AddDocumentRequest {
    int64 AssistantId = 1;
    string FileName = 2;
}

message AddDocumentResponse {
    int64 DocumentId = 1;
}

message DeleteAssistantRequest {
    int64 AssistantId = 1;
    int64 UserId = 2;
}

message DeleteAssistantResponse {
    string Status = 1;
}

message DeleteDocumentRequest {
    int64 DocumentId = 1;
    int64 UserId = 2;
}

message DeleteDocumentResponse {
    string Status = 1;
}

message GetOneAssistantRequest {
    int64 AssistantId = 1;
    string AssistantTag = 2;
}

message GetOneAssistantResponse {
    Assistant Assistant = 1;
}

message GetUserAssistantsRequest {
    int64 UserId = 1;
}

message GetUserAssistantsResponse {
    repeated Assistant Assistants = 1;
}

message GetAssistantDocumentsRequest {
    int64 AssistantId = 1;
}

message GetAssistantDocumentsResponse {
    repeated Document Documents = 1;
}

message UpdateAssistantRequest {
    string NewAssistantName = 1;
    string NewAssistantFirstMessage = 2;
    int64 AssistantId = 3;
    int64 UserId = 4;
}

message UpdateAssistantResponse {
    string Status = 1;
}

message GiveAnswerRequest {
    int64 AssistantId = 1;
    int64 UserId = 2;
    string Question = 3;
    string Answer = 4;
}

message GiveAnswerResponse {
    string Status = 1;
}

message GetAssistantGivenAnswersRequest {
    int64 Assistantid = 1;
}

message GetAssistantGivenAnswersResponse {
    repeated GivenAnswer GivenAnswers = 1;
}

message DeleteGivenAnswerRequest {
    int64 AnswerId = 1;
    int64 UserId = 2;
}

message DeleteGivenAnswerResponse {
    string Status = 1;
}

message CreateAppealRequest {
    string UserQuestion = 1;
    string AssistantAnswer = 2;
    string UserComment = 3;
    int64 AssistantId = 4;
    repeated string ChunksId = 5;
}

message CreateAppealResponse {
    string Status = 1;
}

message GetAssistantAppealsRequest {
    int64 AssistantId = 1;
}

message GetAssistantAppealsResponse {
    repeated Appeal Appeals = 1;
}

message GetUserAssistantsAppealsRequest {
    int64 UserId = 1;
}

message GetUserAssistantsAppealsResponse {
    repeated Appeal Appeals = 1;
}

message AddClientToQueueRequest {
    string ClientId = 1;
    int64 AssistantId = 2;
    string Problem = 3;
    string ClientPlatform = 4;
    repeated Message DialogMessages = 5;
}

message AddClientToQueueResponse {
    int64 ChatId = 1;
}

message GetOperatorChatsRequest {
    int64 OperatorId = 1;
    int64 UserId = 2;
}

message GetOperatorChatsResponse {
    repeated Chat Chats = 1;
}

message GetUserOperatorsRequest {
    int64 UserId = 1;
}

message GetUserOperatorsResponse {
    repeated Operator Operators = 1;
}

message GetOneQueueClientRequest {
    int64 QueueId = 1;
}

message GetOneQueueClientResponse {
    OperatorQueue QueueClient = 1;
}

message GetChatMessagesRequest {
    int64 QueueId = 1;
    string TimeZone = 2;
    int64 OperatorId = 3;
    int64 UserId = 4;
}

message GetChatMessagesResponse {
    repeated Message Messages = 1;
}

message CreateMessageRequest {
    Message Message = 1;
}

message CreateMessageResponse {
    int64 MessageId = 1;
}

message CheckIsOperatorRequest {
    int64 UserId = 1;
    int64 OperatorId = 2;
}

message CheckIsOperatorResponse {
    bool IsOperator = 1;
}

message NewOperatorRequest {
    Operator Operator = 1;
    int64 UserId = 2;
}

message NewOperatorResponse {
    int64 OperatorId = 1;
}

message GetAssistantOperatorsRequest {
    int64 AssistantId = 1;
    int64 UserId = 2;
}

message GetAssistantOperatorsResponse {
    repeated Operator Operators = 1;
}

message CheckIsAssistantOperatorRequest {
    int64 UserId = 1;
    int64 AssistantId = 2;
}

message CheckIsAssistantOperatorResponse {
    bool IsOperator = 1;
}